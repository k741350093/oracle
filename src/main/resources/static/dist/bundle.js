(()=>{"use strict";var e,t,n={},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={exports:{}};return n[e](a,a.exports,r),a.exports}r.m=n,r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>e+".bundle.js",r.miniCssF=e=>{},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="oracle-connection:",r.l=(n,o,a,s)=>{if(e[n])e[n].push(o);else{var i,l;if(void 0!==a)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+a){i=u;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,r.nc&&i.setAttribute("nonce",r.nc),i.setAttribute("data-webpack",t+a),i.src=n),e[n]=[o];var m=(t,o)=>{i.onerror=i.onload=null,clearTimeout(p);var r=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(o))),t)return t(o)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),l&&document.head.appendChild(i)}},r.p="/oracle-fe/",(()=>{var e={792:0};r.f.j=(t,n)=>{var o=r.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var a=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=a);var s=r.p+r.u(t),i=new Error;r.l(s,(n=>{if(r.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var a=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",i.name="ChunkLoadError",i.type=a,i.request=s,o[1](i)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,a,[s,i,l]=n,d=0;if(s.some((t=>0!==e[t]))){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);l&&l(r)}for(t&&t(n);d<s.length;d++)a=s[d],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkoracle_connection=self.webpackChunkoracle_connection||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0,document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("connection-form"),t=document.getElementById("table-form"),n=document.getElementById("connectBtn"),o=document.getElementById("backBtn"),a=(document.getElementById("finishBtn"),document.getElementById("selectedTable")),s=document.getElementById("message"),i=document.getElementById("togglePassword"),l=document.getElementById("password");let d=[],c=null;async function u(e,t){s.textContent=e,s.className=`message ${t}`,s.style.display="block",setTimeout((()=>{s.style.display="none"}),3e3)}function m(){e.style.display="block",t.style.display="none"}n.onclick=async function(){const o=document.getElementById("ip").value,r=parseInt(document.getElementById("port").value,10),s=document.getElementById("username").value,i=document.getElementById("password").value,l=document.getElementById("sid").value;if(o&&r&&s&&i&&l)if(isNaN(r))u("端口必须是数字","error");else{n.disabled=!0,n.textContent="连接中...";try{const n=await fetch("/oracle-connector/list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:o,port:r,username:s,password:i,sid:l})});if(!n.ok)throw new Error("服务器响应异常");const m=await n.json();if(0!==m.code||!m.data||!Array.isArray(m.data.tableList))throw new Error(m.msg||"获取表信息失败");d=m.data.tableList,c={ip:o,port:r,username:s,password:i,sid:l},u("连接成功","success"),a.innerHTML='<option value="">请选择表</option>'+d.map((e=>`<option value="${e}">${e}</option>`)).join(""),e.style.display="none",t.style.display="block"}catch(e){u(e.message||"连接失败","error")}finally{n.disabled=!1,n.textContent="连接数据库"}}else u("请填写完整的连接信息","error")},o.onclick=m,t.onsubmit=async function(e){if(e.preventDefault(),!c)return u("连接信息丢失，请重新连接","error"),void m();if(!a.value)return void u("请选择表","error");const t={...c,tableName:a.value};try{const{bitable:e}=await r.e(972).then(r.bind(r,972));await e.saveConfigAndGoNext(t)}catch(e){console.log("测试环境 - 配置数据:",t),u("配置已收集（测试环境）","success")}},i.addEventListener("click",(function(){"password"===l.type?(l.type="text",i.textContent="隐藏"):(l.type="password",i.textContent="显示")}))}))})();